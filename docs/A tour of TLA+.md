





# TLA+课程



三天半由邓辉在南京的软件设计高级课程，现在缩减为一天，进行了裁剪



上午是TLA+，DDD微服务的概念介绍，下午由马西照带领大家做一个例子。



## 上午课程-陈皓



### 什么是TLA+



- 纯数学工具

- 用公理语义的形式化语言

- 系统规格说明语言



- 形式化语言和自动机理论

- 用简单，实用，高表达力的设计语言

- 并且可以调试，可自动穷尽式验证



### TLA+的设计哲学



使用主义而非



作者是 Lamport



### 如何知道C语言的意思



- 语义机器

  - 变量，赋值，执行控制

- 及其模型

  - C语言，汇编语言，机器指令



为何不在机器模型层面理解程序语义



### TLA+选择出可能的执行序列



C语言模型简单么？有没有更简单的模型来描述这个计算？



有没有可能执行乱序？

程序的执行步骤？



C语言内含顺序执行的执行步骤，PC指针递增。



状态序列

如何选出我们期望的状态序列？



如何找出S1，如何根据S(i)找出S(i+1)



### TLA+数学语言表达



x' x下一步的值，如果不限定，就可以等于任何值



每一步都是布尔表达式，用于过滤出符合条件的所有值



TLA中 AND是 /\

or是 \/



状态空间，所有可能的状态序列，根据逻辑表达式，过滤出可能的状态序列。



### 要点



状态机是通用的计算模型，任何其他计算形式都可以表达为状态机

我们并没有产生一个状态序列，而是描述一个状态机形式



### 新建TLA描述语言



### 运行ModelChecker



遇到死锁了？不是死锁，而是找不到下一个状态了。



### 随机返回1-5的值



5个序列，而不是1个序列



转账的例子

两个互斥体同时转账，这个序列如何描述？



### TLA用到的数学理论



- 一阶逻辑

  - 与或非取反

- 集合操作

  - 交并子集

- 谓词逻辑

  - 对于任意在A中的元素，符合F

  - 存在一个在A中的元素，符合F



一阶逻辑描述状态

时序逻辑描述行为



### 清晰的思考和表达



- 状态有哪些？如何表达？

- 如何定义行为？

- 如何定义不变形？



### 汉诺塔



如何定义柱子，如何定义盘子，如何定义结束的状态？



指定一个不变性，帮助找一种可能。



### 描述一个信号，one bit clock



### Temporal Formula



Temporal Operator



使用Temporal Formula 来描述状态跃迁



stuttering equivalent, 结巴



很多符号表示方法



**怎样描述一个系统永远都不会死**



状态要不断变化。一个0-1信号系统



Safety and Liveness



安全属性和生存属性



安全属性：所有不好的事情都不能发生



生存属性：所有好的事情在未来一定要发生



初始状态+描述状态跃迁+描述将来发生事情+描述安全属性

